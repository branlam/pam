@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor

@{
    var requester = HttpContextAccessor.HttpContext.Session.GetObject<Requester>("Requester");
    var requestFor = HttpContextAccessor.HttpContext.Session.GetObject<Requester>("RequestFor");
    var request = (Request)ViewData["Request"];
    var systems = (List<UnitSystem>)ViewData["Systems"];
    var supervisor = ViewData["Supervisor"];
    ViewData["Title"] = "Review";
}

<body onload="javascript: stepIndicate()">
  <partial name="../Shared/_ProgressBar.cshtml" />
  <form asp-controller="NewRequest" asp-action="Review" method="post">
    <div class="alert alert-warning">
      Please confirm that all information is correct.
    </div>
    <div class="alert alert-success">
      Step 1 - Self or For
      <a class ="float-right" href="/NewRequest/NewRequest"> Edit </a>
    </div>
    @{
      var requestForName = "";
      if (request.RequestedById == request.RequestedForId) { requestForName = requester.Name; }
      else { requestForName = requestFor.Name; }
    }
    <p>This is a request made for <i>@requestForName</i> </p>
    <div class="alert alert-success">
      Step 2 - Requester(s) Information
      <a class ="float-right" href="/NewRequest/RequesterInfo"> Edit </a>
    </div>
    <div class="alert alert-info" style="width:40%;">
      Personal Information
    </div>
      <div class="form-row">
        <div class="form-group col-md-5">
          <label for="countyDeptName">Agency Name</label>
          <input value=@requester.Service class="form-control" id="countyDeptName" disabled />
        </div>
        <div class="form-group col-md-3">
          <label for="countyDeptNum">Dept. #</label>
          <input value="@requester.Department" type="text" class="form-control" id="countyDeptNum" disabled />
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="title">Title</label>
          <input value="@requester.Title" type="text" class="form-control" id="title" disabled />
        </div>
        <div class="form-group col-md-6">
          <label for="section">Section</label>
          <input value="@requester.Section" type="text" class="form-control" id="section" disabled />
        </div>
      </div>
      <hr />
      <div class="form-row">
        <div class="form-group col-md-5">
          <label for="validateFirstName">First Name</label>
          <input value="@requester.FirstName" type="text" class="form-control"disabled />
        </div>
        <div class="form-group col-md-5">
          <label for="validateLastName">Last Name</label>
          <input value="@requester.LastName" type="text" class="form-control" disabled />
        </div>
        <div class="form-group col-md-2">
          <label for="middleName">Middle Name</label>
          <input value="@requester.MiddleName" type="text" class="form-control" id="middleName" disabled />
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-4">
          <label for="workAddr">Address</label>
          <input value="@requester.Address" class="form-control" id="workAddr" disabled /> 
        </div>
        <div class="form-group col-md-3">
          <label for="workCity">City</label>
          <input value="@requester.City" type="text" class="form-control" id="workCity" disabled />
        </div>
        <div class="form-group col-md-2">
          <label for="workState">State</label>
          <input value="@requester.State" type="text" class="form-control" id="workState" disabled />
        </div>
        <div class="form-group col-md-3">
          <label for="workZip">Zip Code</label>
          <input value="@requester.Zip" type="text" class="form-control" id="workZip" disabled />
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="locationPhoneNum">Employee Location Phone #</label>
          <input value="@requester.Phone" class="form-control" id="locationPhoneNum" disabled />
        </div>
        <div class="form-group col-md-6">
          <label for="employeeCellNum">Employee Cell Phone #</label>
          <input value="@requester.CellPhone" class="form-control" id="employeeCellNum" disabled />
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-5">
          <label for="countyEmail">Email Address</label>
          <input value="@requester.Email" type="text" class="form-control" id="countyEmail" disabled /> 
        </div>
      </div>
      <hr />
    <div class="alert alert-success">
      Step 3 - Request Type
      <a class ="float-right" href="/NewRequest/RequestType"> Edit </a>
    </div>
    <p> This is a request to: <i>@request.RequestType.DisplayCode</i> </p>
    <div class="alert alert-success">
      Step 4 - Unit Selection
      <a class ="float-right" href="/Request/SelectUnit"> Edit </a>
    </div>
    <p> The unit selected is: <i>@systems.First().Unit.Name</i></p>
    <div class="alert alert-success">
      Step 5 - Systems Associated 
    </div>
    <table class="table table-hover">
      <thead class="table-info">
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        @foreach (var system in systems)
        {
          <tr>
            <td>@system.System.Name;</td>
            <td>@system.System.Description;</td>
          </tr>
        }
      </tbody>
    </table>
    <div class="alert alert-success">
      Step 6 - Additional Request Information
      <a class ="float-right" href="/NewRequest/RequestInfo"> Edit </a>
    </div>
    @{
      if (request.IsHighProfileAccess)
      {
        @Html.Raw("<p> This request requires <i>High Profile Access</i></p>") };
      if (request.IsGlobalAccess)
      {
        @Html.Raw("<p> This request requires <i>Global Access</i></p>") };
      if (request.IsContractor)
      {
        @Html.Raw("<p> This request is made for a <i>contractor</i></p>") };
      if (request.CaseloadNumber != null)
      {
        @Html.Raw("<p> The Case Load number for this request is: <i>") @request.CaseloadNumber @Html.Raw("</i></p>") };
      if (request.CaseloadFunction != null)
      {
        @Html.Raw("<p> The Case Load function for this request is: <i>") @request.CaseloadFunction @Html.Raw("</i></p>") };
      if (request.CaseloadType != null)
      {
        @Html.Raw("<p> The Case Load Type for this request is: <i>") @request.CaseloadType @Html.Raw("</i></p>") };
    }

    <div class="alert alert-success">
      Step 7 - Supervisor's Review
      <a class ="float-right" href="/NewRequest/Supervisors"> Edit </a>
    </div>
    <p> This request will be reviewed by: <i>@supervisor</i> </p>
    <div style="display:flex;" class="justify-content-center">
      <button type="submit" class="btn btn-primary">Confirm Submit</button>
    </div>
  </form>
</body>
